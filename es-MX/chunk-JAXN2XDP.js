import{a as G,d as z,e as W,f as U,l as X,m as q,o as J,p as K}from"./chunk-UHCKC5VU.js";import{b as V,c as A,d as O,e as H,f as R,g as L,h as j}from"./chunk-U662JCHK.js";import"./chunk-MKZTZUHH.js";import{$ as p,$a as x,D as k,Fa as M,Ga as D,Ha as B,I as m,J as h,Ja as I,La as N,R as E,S as d,T as C,V as r,X as P,Z as a,a as y,aa as l,ab as f,ba as u,ca as b,ia as _,ja as g,kb as $,t as S,va as w,xa as F,ya as v,za as T}from"./chunk-CRGJQDHV.js";var Q=i=>({"sf-feed__section__responsive-display":i});function Z(i,n){if(i&1){let c=b();p(0,"sf-post-refresh",11),_("refresh",function(){m(c);let s=g();return h(s.getData());}),l();}}function ee(i,n){if(i&1){let c=b();p(0,"sf-post",12),_("commentChange",function(s){let e=m(c).$implicit,o=g();return h(o.commentPost(e,s));})("likeChange",function(){let s=m(c).$implicit,e=g();return h(e.likePost(s));}),l();}if(i&2){let c=n.$implicit;a("post",c);}}function te(i,n){i&1&&u(0,"sf-post-placeholder");}var Fe=(()=>{let n=class n{constructor(t,s){this.store=t,this.authStore=s,this.feedPosts=r([]),this.user=r(null),this.displayMenu=r(!1),this.displayFriends=r(!1),this.displayPostPlaceholder=r(!0),this.loading=r(!1),this.currentPage=r(1),this.totalPages=r(1),this.trackByPostId=(e,o)=>o.id,this.getData(),this.loadingSubscription=this.store.pipe(f(X)).subscribe(e=>{this.loading.set(e);}),this.errorFetching$=this.store.pipe(f(q),S(e=>{e&&this.feedPosts().length==0&&this.currentPage.set(1);})),this.totalPagesSubscription=this.store.pipe(f(J)).subscribe(e=>this.totalPages.set(e)),this.postsSub=this.store.pipe(f(K)).subscribe(e=>{this.feedPosts.set(e);}),this.userSubscription=this.authStore.pipe(f($)).subscribe(e=>{this.user.set(e);});}ngOnDestroy(){this.postsSub.unsubscribe(),this.userSubscription.unsubscribe(),this.totalPagesSubscription.unsubscribe(),this.loadingSubscription.unsubscribe();}onWindowScroll(){let t=(document.documentElement.scrollTop||document.body.scrollTop)+document.documentElement.offsetHeight,s=document.documentElement.scrollHeight;t+180>=s&&this.getPosts();}getPosts(){!this.loading()&&this.currentPage()<=this.totalPages()&&(this.store.dispatch(G({pageNumber:this.currentPage()})),this.currentPage.set(this.currentPage()+1));}getData(){this.getPosts(),this.store.dispatch(z());}toggleDisplayMenu(){let t=this.displayMenu();this.displayMenu.set(!t);}toggleDisplayFrieds(){let t=this.displayFriends();this.displayFriends.set(!t);}likePost(t){let s=y({},t);s.liked=!t.liked,this.store.dispatch(U({post:s}));}commentPost(t,s){let e=y({},t),o={comment:s,postId:t.id,userData:this.user()};e.comments=t.comments?t.comments.concat([o]):[o],this.store.dispatch(W({post:e}));}};n.ɵfac=function(s){return new(s||n)(C(x),C(x));},n.ɵcmp=k({type:n,selectors:[["sf-feed"]],hostBindings:function(s,e){s&1&&_("scroll",function(Y){return e.onWindowScroll(Y);},!1,E);},standalone:!0,features:[w],decls:12,vars:15,consts:()=>{let t;return t="Publicaciones de Inicio",[[3,"menuButtonClick","friendsButtonClick"],[1,"sf-feed"],["tabindex","1","data-test-id","menu-sidebar",1,"sf-feed__section",3,"ngClass"],[3,"user"],["tabindex","3","aria-label",t,1,"sf-feed__content"],[1,"sf-feed__content__posts"],[3,"refresh",4,"ngIf"],[3,"post","commentChange","likeChange",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["tabindex","2","data-test-id","friends-sidebar",1,"sf-feed__section",3,"ngClass"],[3,"user","displayRightComponent"],[3,"refresh"],[3,"commentChange","likeChange","post"]];},template:function(s,e){s&1&&(p(0,"sf-header",0),_("menuButtonClick",function(){return e.toggleDisplayMenu();})("friendsButtonClick",function(){return e.toggleDisplayFrieds();}),l(),p(1,"div",1)(2,"section",2),u(3,"sf-sidebar",3),l(),p(4,"section",4)(5,"div",5),P(6,Z,1,0,"sf-post-refresh",6),v(7,"async"),P(8,ee,1,1,"sf-post",7)(9,te,1,0,"sf-post-placeholder",8),l()(),p(10,"section",9),u(11,"sf-sidebar",10),l()()),s&2&&(d(2),a("ngClass",F(11,Q,e.displayMenu())),d(),a("user",e.user()),d(3),a("ngIf",T(7,9,e.errorFetching$)),d(2),a("ngForOf",e.feedPosts())("ngForTrackBy",e.trackByPostId),d(),a("ngIf",e.loading()||e.currentPage()<e.totalPages()),d(),a("ngClass",F(13,Q,e.displayFriends())),d(),a("user",e.user())("displayRightComponent",!0));},dependencies:[N,M,D,B,I,j,A,O,H,R,L,V],styles:[`.sf-feed{padding-top:75px;background-color:#f3f6f8;min-height:calc(100% - 90px);display:flex;justify-content:center}.sf-feed__section{width:350px;flex-shrink:0}.sf-feed__content{display:flex;justify-content:center;margin:20px 80px 30px}.sf-feed__content__posts{min-width:500px;max-width:700px;display:flex;flex-direction:column;gap:20px}@media only screen and (min-width: 1280px) and (max-width: 1366px){.sf-feed__content{margin-left:20px;margin-right:20px}}@media only screen and (max-width: 1279px){.sf-feed__section__responsive-display:first-child{display:block!important}.sf-feed__section:first-child{display:none;position:fixed;left:0;top:0;background-color:#fff;height:100%;overflow-y:auto;z-index:99}.sf-feed__section:first-child .sf-feed__sidebar{position:relative}.sf-feed__content__posts{min-width:unset}.sf-header__section>button:not(.sf-header__section__chat-button){display:block!important}}@media only screen and (max-width: 1023px){.sf-feed__content{margin-left:20px;margin-right:20px}.sf-feed__section__responsive-display:last-child{display:block!important}.sf-feed__section:last-child{display:none;position:fixed;right:0;top:0;background-color:#fff;height:100%;overflow-y:auto;z-index:99}.sf-feed__section:last-child__responsive-display{display:block}.sf-feed__section:last-child .sf-feed__sidebar{position:relative}sf-feed .sf-header__section__chat-button{display:block!important}}
`],encapsulation:2});let i=n;return i;})();export{Fe as FeedComponent};/**i18n:09bae54218b88e4f05ff41eae164937f157eca229141359bef14509b10ad6ed6*/